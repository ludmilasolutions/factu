<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuraci√≥n Inicial | POS Ferreter√≠a Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .setup-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
        }
        
        .setup-header {
            background: linear-gradient(90deg, #0d3b66, #1a5f9e);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .setup-header::before {
            content: "üîß";
            font-size: 4rem;
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.2;
        }
        
        .setup-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .setup-header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .warning-banner {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px;
            border-radius: 8px;
        }
        
        .warning-banner h3 {
            color: #856404;
            margin-bottom: 5px;
        }
        
        .setup-steps {
            padding: 30px;
        }
        
        .step {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-number {
            background: #0d3b66;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .step-title {
            font-size: 1.3rem;
            color: #1f2937;
            font-weight: 600;
        }
        
        .step-content {
            padding-left: 51px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #4b5563;
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #0d3b66;
            box-shadow: 0 0 0 3px rgba(13, 59, 102, 0.1);
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        .firebase-config {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .test-users {
            background: #e8f4fd;
            border: 1px solid #b6e0fe;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .test-user {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid #d1e9ff;
        }
        
        .test-user:last-child {
            border-bottom: none;
        }
        
        .setup-actions {
            padding: 20px 30px;
            background: #f9fafb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #0d3b66;
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: #0a2d4d;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(13, 59, 102, 0.3);
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .status-message {
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        
        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
        
        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            display: block;
        }
        
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: #0d3b66;
            width: 0%;
            transition: width 0.3s;
        }
        
        .setup-complete {
            text-align: center;
            padding: 40px 30px;
            display: none;
        }
        
        .setup-complete h2 {
            color: #155724;
            margin-bottom: 20px;
        }
        
        .setup-complete .success-icon {
            font-size: 4rem;
            color: #28a745;
            margin-bottom: 20px;
        }
        
        .credentials {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .credential-item {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #e5e7eb;
        }
        
        .credential-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .auto-fill-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 10px;
            margin-bottom: 15px;
        }
        
        .auto-fill-btn:hover {
            background: #218838;
        }
        
        .hardware-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .hardware-option {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .hardware-option:hover {
            border-color: #0d3b66;
            background: #f0f7ff;
        }
        
        .hardware-option.selected {
            border-color: #0d3b66;
            background: #e8f4fd;
        }
        
        .hardware-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .ferreteria-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .category-tag {
            background: #e8f4fd;
            border: 1px solid #b6e0fe;
            border-radius: 20px;
            padding: 8px 15px;
            text-align: center;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .category-tag:hover {
            background: #d1e9ff;
        }
        
        .category-tag.selected {
            background: #0d3b66;
            color: white;
            border-color: #0d3b66;
        }
        
        .inventory-settings {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .ferreteria-features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .feature-check {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .required::after {
            content: " *";
            color: #dc2626;
        }
    </style>
</head>
<body>
    <div class="setup-container">
        <div class="setup-header">
            <h1>üîß Configuraci√≥n Inicial Ferreter√≠a</h1>
            <p>POS Ferreter√≠a Pro - Sistema especializado para ferreter√≠as y corralones</p>
        </div>
        
        <div class="warning-banner">
            <h3>‚ö†Ô∏è ATENCI√ìN: CONFIGURACI√ìN √öNICA</h3>
            <p>Este setup debe ejecutarse <strong>UNA SOLA VEZ</strong> para inicializar el sistema. Aseg√∫rate de tener:</p>
            <p>1. Proyecto Firebase creado con Firestore y Authentication habilitados</p>
            <p>2. Permisos de administrador en el proyecto</p>
            <p>3. Conexi√≥n a internet estable durante la configuraci√≥n</p>
        </div>
        
        <div id="setup-form">
            <div class="setup-steps">
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-title">Configuraci√≥n Firebase</div>
                    </div>
                    <div class="step-content">
                        <p>La configuraci√≥n de Firebase ya est√° incluida. Verifica la conexi√≥n antes de continuar.</p>
                        
                        <div class="form-group">
                            <label for="firebase-config">Configuraci√≥n Firebase</label>
                            <textarea id="firebase-config" rows="6" class="firebase-config" readonly>{
  "apiKey": "AIzaSyCtOiUy2tUQeixUiJxTdI_ESULY4WpqXzw",
  "authDomain": "whatsappau-30dc1.firebaseapp.com",
  "projectId": "whatsappau-30dc1",
  "storageBucket": "whatsappau-30dc1.firebasestorage.app",
  "messagingSenderId": "456068013185",
  "appId": "1:456068013185:web:5bdd49337fb622e56f0180"
}</textarea>
                        </div>
                        
                        <div class="form-group">
                            <button id="test-connection" class="btn btn-secondary" style="width: auto;">üîó Probar Conexi√≥n Firebase</button>
                            <span id="connection-test-result" style="margin-left: 10px;"></span>
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-title">Datos de la Ferreter√≠a</div>
                    </div>
                    <div class="step-content">
                        <button id="auto-fill-ferreteria" class="auto-fill-btn">üîÑ Rellenar con datos de ferreter√≠a</button>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="business-name" class="required">Nombre de la Ferreter√≠a</label>
                                <input type="text" id="business-name" placeholder="Ej: Ferreter√≠a El Clavo S.A." required>
                            </div>
                            <div class="form-group">
                                <label for="business-cuit">CUIT / CUIL</label>
                                <input type="text" id="business-cuit" placeholder="30-12345678-9">
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="business-address" class="required">Direcci√≥n Comercial</label>
                                <input type="text" id="business-address" placeholder="Av. Principal 1234, Localidad" required>
                            </div>
                            <div class="form-group">
                                <label for="business-phone">Tel√©fono Principal</label>
                                <input type="text" id="business-phone" placeholder="+54 11 1234-5678">
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="business-email">Email</label>
                                <input type="email" id="business-email" placeholder="ventas@ferreteria.com">
                            </div>
                            <div class="form-group">
                                <label for="business-website">Sitio Web</label>
                                <input type="text" id="business-website" placeholder="https://www.ferreteria.com">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="business-description">Descripci√≥n / Rubro</label>
                            <textarea id="business-description" rows="2" placeholder="Ferreter√≠a industrial, materiales de construcci√≥n, herramientas el√©ctricas..."></textarea>
                        </div>
                        
                        <div class="ferreteria-features">
                            <div class="feature-check">
                                <input type="checkbox" id="feature-construction" checked>
                                <label for="feature-construction">üì¶ Materiales de construcci√≥n</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-tools" checked>
                                <label for="feature-tools">üîß Herramientas manuales</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-electric" checked>
                                <label for="feature-electric">‚ö° Herramientas el√©ctricas</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-paint" checked>
                                <label for="feature-paint">üé® Pinturer√≠a</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-plumbing" checked>
                                <label for="feature-plumbing">üö∞ Sanitarios y grifer√≠a</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-electricity">
                                <label for="feature-electricity">üí° Material el√©ctrico</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-security">
                                <label for="feature-security">üîê Cerrajer√≠a y seguridad</label>
                            </div>
                            <div class="feature-check">
                                <input type="checkbox" id="feature-garden">
                                <label for="feature-garden">üåø Jardiner√≠a</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-title">Local / Sucursal Principal</div>
                    </div>
                    <div class="step-content">
                        <p>Configura el local principal donde operar√° el sistema.</p>
                        
                        <div class="grid-3">
                            <div class="form-group">
                                <label for="local-name" class="required">Nombre del Local</label>
                                <input type="text" id="local-name" placeholder="Ej: Sucursal Centro" required>
                            </div>
                            <div class="form-group">
                                <label for="local-code" class="required">C√≥digo (3 letras)</label>
                                <input type="text" id="local-code" placeholder="CEN" maxlength="3" required style="text-transform: uppercase;">
                            </div>
                            <div class="form-group">
                                <label for="local-type">Tipo de Local</label>
                                <select id="local-type">
                                    <option value="ferreteria">Ferreter√≠a</option>
                                    <option value="corralon">Corral√≥n</option>
                                    <option value="industrial">Ferreter√≠a Industrial</option>
                                    <option value="hogar">Ferreter√≠a para el Hogar</option>
                                    <option value="especializada">Ferreter√≠a Especializada</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="local-address">Direcci√≥n del Local</label>
                                <input type="text" id="local-address" placeholder="Calle Principal 456">
                            </div>
                            <div class="form-group">
                                <label for="local-phone">Tel√©fono Local</label>
                                <input type="text" id="local-phone" placeholder="+54 11 8765-4321">
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="local-opening">Horario de Atenci√≥n</label>
                                <input type="text" id="local-opening" placeholder="Lun a Vie: 8:00 - 18:00, S√°b: 8:00 - 13:00" value="Lun a Vie: 8:00 - 18:00, S√°b: 8:00 - 13:00">
                            </div>
                            <div class="form-group">
                                <label for="local-manager">Encargado / Responsable</label>
                                <input type="text" id="local-manager" placeholder="Nombre del encargado">
                            </div>
                        </div>
                        
                        <div class="inventory-settings">
                            <h4>üî¢ Configuraci√≥n de Inventario</h4>
                            <div class="grid-3">
                                <div class="form-group">
                                    <label for="stock-alert">Alerta Stock M√≠nimo</label>
                                    <input type="number" id="stock-alert" value="5" min="1">
                                </div>
                                <div class="form-group">
                                    <label for="stock-max">Stock M√°ximo Sugerido</label>
                                    <input type="number" id="stock-max" value="100" min="10">
                                </div>
                                <div class="form-group">
                                    <label for="decimal-units">Decimales en Unidades</label>
                                    <select id="decimal-units">
                                        <option value="0">0 (unidades enteras)</option>
                                        <option value="1">1 (ej: 0.5)</option>
                                        <option value="2" selected>2 (ej: 0.25)</option>
                                        <option value="3">3 (ej: 0.125)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-title">Usuarios del Sistema</div>
                    </div>
                    <div class="step-content">
                        <p>Se crear√°n usuarios de prueba para cada rol. <strong>Cambia las contrase√±as despu√©s del primer login.</strong></p>
                        
                        <div class="test-users">
                            <div class="test-user">
                                <div>
                                    <strong>üîë Administrador</strong><br>
                                    admin@ferreteria.com
                                </div>
                                <div>Contrase√±a: Admin123!</div>
                            </div>
                            <div class="test-user">
                                <div>
                                    <strong>üí∞ Cajero Principal</strong><br>
                                    cajero@ferreteria.com
                                </div>
                                <div>Contrase√±a: Cajero123!</div>
                            </div>
                            <div class="test-user">
                                <div>
                                    <strong>üë∑ Vendedor / Asesor</strong><br>
                                    vendedor@ferreteria.com
                                </div>
                                <div>Contrase√±a: Vendedor123!</div>
                            </div>
                            <div class="test-user">
                                <div>
                                    <strong>üì¶ Deposito / Stock</strong><br>
                                    deposito@ferreteria.com
                                </div>
                                <div>Contrase√±a: Deposito123!</div>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="admin-email">Email Administrador Personalizado (opcional)</label>
                            <input type="email" id="admin-email" placeholder="tucorreo@ferreteria.com">
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-title">Productos de Ferreter√≠a</div>
                    </div>
                    <div class="step-content">
                        <p>Se crear√°n productos de ejemplo t√≠picos de ferreter√≠a.</p>
                        
                        <div class="form-group">
                            <label>Selecciona categor√≠as para crear productos:</label>
                            <div class="ferreteria-categories">
                                <div class="category-tag selected" data-category="herramientas">üîß Herramientas</div>
                                <div class="category-tag selected" data-category="materiales">üß± Materiales</div>
                                <div class="category-tag selected" data-category="electricidad">üí° Electricidad</div>
                                <div class="category-tag selected" data-category="plomeria">üö∞ Plomer√≠a</div>
                                <div class="category-tag" data-category="pintura">üé® Pintura</div>
                                <div class="category-tag" data-category="seguridad">üîê Seguridad</div>
                                <div class="category-tag" data-category="jardin">üåø Jard√≠n</div>
                                <div class="category-tag" data-category="fijacion">üìå Fijaci√≥n</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="products-count">Cantidad de productos por categor√≠a</label>
                            <select id="products-count">
                                <option value="10">10 productos</option>
                                <option value="20" selected>20 productos</option>
                                <option value="30">30 productos</option>
                                <option value="50">50 productos</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="create-products" checked>
                                Crear productos de ferreter√≠a de ejemplo
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="create-suppliers" checked>
                                Crear proveedores de ferreter√≠a
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-header">
                        <div class="step-number">6</div>
                        <div class="step-title">Hardware POS (Opcional)</div>
                    </div>
                    <div class="step-content">
                        <p>Selecciona el hardware que usar√°s para integrar con el sistema:</p>
                        
                        <div class="hardware-options">
                            <div class="hardware-option" data-hardware="scanner">
                                <div class="hardware-icon">üì∑</div>
                                <h4>Esc√°ner de C√≥digos</h4>
                                <small>Lector de c√≥digo de barras USB</small>
                            </div>
                            <div class="hardware-option" data-hardware="printer">
                                <div class="hardware-icon">üñ®Ô∏è</div>
                                <h4>Impresora de Tickets</h4>
                                <small>Impresora t√©rmica 80mm</small>
                            </div>
                            <div class="hardware-option" data-hardware="cashdrawer">
                                <div class="hardware-icon">üí∞</div>
                                <h4>Caj√≥n de Dinero</h4>
                                <small>Caj√≥n electr√≥nico conectado</small>
                            </div>
                            <div class="hardware-option" data-hardware="barcode">
                                <div class="hardware-icon">üè∑Ô∏è</div>
                                <h4>Impresora Etiquetas</h4>
                                <small>Para precios y c√≥digos</small>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="hardware-notes">Notas sobre hardware:</label>
                            <textarea id="hardware-notes" rows="2" placeholder="Modelos, marcas, configuraciones especiales..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="status-messages"></div>
            
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            
            <div class="setup-actions">
                <div>
                    <strong id="current-operation">Listo para configurar sistema de ferreter√≠a</strong>
                </div>
                <div>
                    <button id="start-setup" class="btn btn-primary">üöÄ Iniciar Configuraci√≥n</button>
                </div>
            </div>
        </div>
        
        <div id="setup-complete" class="setup-complete">
            <div class="success-icon">‚úÖ</div>
            <h2>¬°Ferreter√≠a Configurada!</h2>
            <p>El sistema POS Ferreter√≠a Pro ha sido configurado exitosamente.</p>
            
            <div class="credentials">
                <h3>üîê Credenciales de Acceso:</h3>
                <div class="credential-item">
                    <strong>Administrador:</strong><br>
                    admin@ferreteria.com / Admin123!
                </div>
                <div class="credential-item">
                    <strong>Cajero Principal:</strong><br>
                    cajero@ferreteria.com / Cajero123!
                </div>
                <div class="credential-item">
                    <strong>Vendedor:</strong><br>
                    vendedor@ferreteria.com / Vendedor123!
                </div>
                <div class="credential-item">
                    <strong>Dep√≥sito:</strong><br>
                    deposito@ferreteria.com / Deposito123!
                </div>
            </div>
            
            <p><strong>üî• Configuraci√≥n Firebase Usada:</strong></p>
            <div class="firebase-config" style="margin: 15px 0; text-align: left; font-size: 0.8rem;">
{
  "apiKey": "AIzaSyCtOiUy2tUQeixUiJxTdI_ESULY4WpqXzw",
  "authDomain": "whatsappau-30dc1.firebaseapp.com",
  "projectId": "whatsappau-30dc1",
  "storageBucket": "whatsappau-30dc1.firebasestorage.app",
  "messagingSenderId": "456068013185",
  "appId": "1:456068013185:web:5bdd49337fb622e56f0180"
}
            </div>
            
            <div class="warning-banner" style="margin: 20px 0;">
                <h3>‚ö†Ô∏è ACCIONES RECOMENDADAS:</h3>
                <p>1. <strong>Cambia las contrase√±as</strong> despu√©s del primer login</p>
                <p>2. <strong>Configura las reglas de seguridad</strong> en Firebase Console</p>
                <p>3. <strong>Agrega m√°s productos</strong> espec√≠ficos de tu ferreter√≠a</p>
                <p>4. <strong>Configura impuestos</strong> seg√∫n tu localidad</p>
            </div>
            
            <div style="margin-top: 30px;">
                <a href="index.html" class="btn btn-primary" style="text-decoration: none; display: inline-block; margin-right: 10px; padding: 12px 30px;">üöÄ Ir al Sistema POS</a>
                <button id="copy-credentials" class="btn btn-success" style="display: inline-block;">üìã Copiar Credenciales</button>
            </div>
            
            <div style="margin-top: 20px; color: #666; font-size: 0.9rem;">
                <p>üí° <strong>Soporte:</strong> En caso de problemas, verifica las reglas de Firestore y habilita Authentication</p>
            </div>
        </div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <script>
        // Elementos del DOM
        const setupForm = document.getElementById('setup-form');
        const setupComplete = document.getElementById('setup-complete');
        const startSetupBtn = document.getElementById('start-setup');
        const testConnectionBtn = document.getElementById('test-connection');
        const statusMessages = document.getElementById('status-messages');
        const progressFill = document.getElementById('progress-fill');
        const currentOperation = document.getElementById('current-operation');
        const connectionTestResult = document.getElementById('connection-test-result');
        const autoFillFerreteriaBtn = document.getElementById('auto-fill-ferreteria');
        const copyCredentialsBtn = document.getElementById('copy-credentials');
        const categoryTags = document.querySelectorAll('.category-tag');
        const hardwareOptions = document.querySelectorAll('.hardware-option');
        
        // Estado de la configuraci√≥n
        let firebaseApp = null;
        let db = null;
        let auth = null;
        let isConfiguring = false;
        let selectedCategories = ['herramientas', 'materiales', 'electricidad', 'plomeria'];
        let selectedHardware = [];
        
        // Configuraci√≥n Firebase proporcionada
        const defaultFirebaseConfig = {
            apiKey: "AIzaSyCtOiUy2tUQeixUiJxTdI_ESULY4WpqXzw",
            authDomain: "whatsappau-30dc1.firebaseapp.com",
            projectId: "whatsappau-30dc1",
            storageBucket: "whatsappau-30dc1.firebasestorage.app",
            messagingSenderId: "456068013185",
            appId: "1:456068013185:web:5bdd49337fb622e56f0180"
        };
        
        // Manejar selecci√≥n de categor√≠as
        categoryTags.forEach(tag => {
            tag.addEventListener('click', () => {
                const category = tag.dataset.category;
                tag.classList.toggle('selected');
                
                if (tag.classList.contains('selected')) {
                    if (!selectedCategories.includes(category)) {
                        selectedCategories.push(category);
                    }
                } else {
                    selectedCategories = selectedCategories.filter(c => c !== category);
                }
            });
        });
        
        // Manejar selecci√≥n de hardware
        hardwareOptions.forEach(option => {
            option.addEventListener('click', () => {
                option.classList.toggle('selected');
                const hardware = option.dataset.hardware;
                
                if (option.classList.contains('selected')) {
                    if (!selectedHardware.includes(hardware)) {
                        selectedHardware.push(hardware);
                    }
                } else {
                    selectedHardware = selectedHardware.filter(h => h !== hardware);
                }
            });
        });
        
        // Auto-rellenar datos de ferreter√≠a
        autoFillFerreteriaBtn.addEventListener('click', () => {
            // Datos de la ferreter√≠a
            document.getElementById('business-name').value = 'Ferreter√≠a El Clavo S.R.L.';
            document.getElementById('business-cuit').value = '30-12345678-9';
            document.getElementById('business-address').value = 'Av. Industrial 2345, Parque Industrial, Buenos Aires';
            document.getElementById('business-phone').value = '+54 11 4321-9876';
            document.getElementById('business-email').value = 'ventas@ferreteriaelclavo.com';
            document.getElementById('business-website').value = 'https://www.ferreteriaelclavo.com';
            document.getElementById('business-description').value = 'Ferreter√≠a industrial y materiales de construcci√≥n. Especialistas en herramientas el√©ctricas y suministros para la construcci√≥n.';
            
            // Datos del local
            document.getElementById('local-name').value = 'Casa Central';
            document.getElementById('local-code').value = 'CEN';
            document.getElementById('local-type').value = 'industrial';
            document.getElementById('local-address').value = 'Av. Industrial 2345';
            document.getElementById('local-phone').value = '+54 11 4321-9876';
            document.getElementById('local-manager').value = 'Juan P√©rez';
            
            // Configuraci√≥n de inventario
            document.getElementById('stock-alert').value = 5;
            document.getElementById('stock-max').value = 150;
            document.getElementById('decimal-units').value = '2';
            
            // Categor√≠as seleccionadas
            document.querySelectorAll('.category-tag').forEach(tag => {
                tag.classList.add('selected');
                selectedCategories.push(tag.dataset.category);
            });
            
            selectedCategories = [...new Set(selectedCategories)]; // Eliminar duplicados
            
            showStatus('Datos de ferreter√≠a cargados. Revisa y modifica seg√∫n sea necesario.', 'success');
        });
        
        // Probar conexi√≥n a Firebase
        testConnectionBtn.addEventListener('click', async () => {
            connectionTestResult.innerHTML = '<span style="color: #059669;">üîç Probando conexi√≥n...</span>';
            
            try {
                // Usar configuraci√≥n por defecto
                firebaseApp = firebase.initializeApp(defaultFirebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                
                // Probar conexi√≥n simple
                await db.collection('test').limit(1).get();
                
                connectionTestResult.innerHTML = '<span style="color: #059669;">‚úÖ Conexi√≥n exitosa a Firebase</span>';
                startSetupBtn.disabled = false;
                
                showStatus('Conexi√≥n establecida correctamente. El proyecto Firebase est√° activo.', 'success');
                
            } catch (error) {
                console.error('Error de conexi√≥n:', error);
                let errorMessage = `Error: ${error.message}`;
                
                if (error.code === 'failed-precondition') {
                    errorMessage = 'Error: Firestore no est√° habilitado. Act√≠valo en Firebase Console.';
                } else if (error.code === 'permission-denied') {
                    errorMessage = 'Error: Permisos insuficientes. Verifica las reglas de seguridad.';
                }
                
                connectionTestResult.innerHTML = `<span style="color: #dc2626;">${errorMessage}</span>`;
                startSetupBtn.disabled = true;
                
                showStatus(`Error de conexi√≥n: ${errorMessage}`, 'error');
            }
        });
        
        // Copiar credenciales al portapapeles
        if (copyCredentialsBtn) {
            copyCredentialsBtn.addEventListener('click', () => {
                const credentials = `
Credenciales POS Ferreter√≠a Pro:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Administrador: admin@ferreteria.com / Admin123!
Cajero: cajero@ferreteria.com / Cajero123!
Vendedor: vendedor@ferreteria.com / Vendedor123!
Dep√≥sito: deposito@ferreteria.com / Deposito123!

URL del sistema: [tu_dominio]/index.html

Configuraci√≥n Firebase:
{
  "apiKey": "AIzaSyCtOiUy2tUQeixUiJxTdI_ESULY4WpqXzw",
  "authDomain": "whatsappau-30dc1.firebaseapp.com",
  "projectId": "whatsappau-30dc1",
  "storageBucket": "whatsappau-30dc1.firebasestorage.app",
  "messagingSenderId": "456068013185",
  "appId": "1:456068013185:web:5bdd49337fb622e56f0180"
}

‚ö†Ô∏è IMPORTANTE: Cambia las contrase√±as despu√©s del primer login.
                `;
                
                navigator.clipboard.writeText(credentials)
                    .then(() => {
                        const originalText = copyCredentialsBtn.textContent;
                        copyCredentialsBtn.textContent = '‚úì Credenciales Copiadas';
                        copyCredentialsBtn.style.background = '#28a745';
                        
                        setTimeout(() => {
                            copyCredentialsBtn.textContent = originalText;
                            copyCredentialsBtn.style.background = '';
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Error al copiar: ', err);
                        showStatus('Error al copiar al portapapeles', 'error');
                    });
            });
        }
        
        // Iniciar configuraci√≥n completa
        startSetupBtn.addEventListener('click', async () => {
            if (isConfiguring) return;
            
            // Validar campos requeridos
            if (!validateRequiredFields()) {
                return;
            }
            
            if (selectedCategories.length === 0) {
                showError('Selecciona al menos una categor√≠a de productos');
                return;
            }
            
            isConfiguring = true;
            startSetupBtn.disabled = true;
            startSetupBtn.textContent = 'Configurando Ferreter√≠a...';
            
            // Recopilar datos del formulario
            const businessData = {
                name: document.getElementById('business-name').value,
                cuit: document.getElementById('business-cuit').value || null,
                address: document.getElementById('business-address').value,
                phone: document.getElementById('business-phone').value || null,
                email: document.getElementById('business-email').value || null,
                website: document.getElementById('business-website').value || null,
                description: document.getElementById('business-description').value || null,
                type: 'ferreteria',
                features: {
                    construction: document.getElementById('feature-construction').checked,
                    tools: document.getElementById('feature-tools').checked,
                    electric: document.getElementById('feature-electric').checked,
                    paint: document.getElementById('feature-paint').checked,
                    plumbing: document.getElementById('feature-plumbing').checked,
                    electricity: document.getElementById('feature-electricity').checked,
                    security: document.getElementById('feature-security').checked,
                    garden: document.getElementById('feature-garden').checked
                },
                createdAt: new Date().toISOString()
            };
            
            const localData = {
                name: document.getElementById('local-name').value,
                code: document.getElementById('local-code').value.toUpperCase(),
                type: document.getElementById('local-type').value,
                address: document.getElementById('local-address').value,
                phone: document.getElementById('local-phone').value || null,
                openingHours: document.getElementById('local-opening').value,
                manager: document.getElementById('local-manager').value || null,
                inventorySettings: {
                    lowStockAlert: parseInt(document.getElementById('stock-alert').value),
                    maxStock: parseInt(document.getElementById('stock-max').value),
                    decimalUnits: parseInt(document.getElementById('decimal-units').value)
                },
                hardware: selectedHardware,
                hardwareNotes: document.getElementById('hardware-notes').value || null,
                isActive: true,
                createdAt: new Date().toISOString()
            };
            
            const adminEmail = document.getElementById('admin-email').value || 'admin@ferreteria.com';
            const createProducts = document.getElementById('create-products').checked;
            const createSuppliers = document.getElementById('create-suppliers').checked;
            const productsCount = parseInt(document.getElementById('products-count').value);
            
            try {
                // Paso 1: Crear estructura de colecciones
                updateProgress('Creando estructura de base de datos...', 10);
                await createDatabaseStructure();
                
                // Paso 2: Crear negocio principal
                updateProgress('Creando datos de la ferreter√≠a...', 20);
                const businessId = await createBusiness(businessData);
                
                // Paso 3: Crear local principal
                updateProgress('Configurando local principal...', 30);
                const localId = await createLocal(localData, businessId);
                
                // Paso 4: Crear usuarios
                updateProgress('Creando usuarios del sistema...', 45);
                await createFerreteriaUsers(adminEmail, localId);
                
                // Paso 5: Crear proveedores
                if (createSuppliers) {
                    updateProgress('Creando proveedores de ferreter√≠a...', 55);
                    await createFerreteriaSuppliers(localId);
                }
                
                // Paso 6: Crear categor√≠as y productos
                if (createProducts) {
                    updateProgress('Creando productos de ferreter√≠a...', 70);
                    await createFerreteriaProducts(localId, selectedCategories, productsCount);
                }
                
                // Paso 7: Configurar sistema
                updateProgress('Configurando sistema de ferreter√≠a...', 90);
                await setupFerreteriaSystem(localId, businessData);
                
                // Finalizar
                updateProgress('Configuraci√≥n completada', 100);
                
                // Mostrar pantalla de √©xito
                setTimeout(() => {
                    setupForm.style.display = 'none';
                    setupComplete.style.display = 'block';
                    
                    // Hacer scroll al inicio
                    window.scrollTo(0, 0);
                }, 1000);
                
            } catch (error) {
                showError(`Error durante la configuraci√≥n: ${error.message}`);
                console.error('Setup error:', error);
                isConfiguring = false;
                startSetupBtn.disabled = false;
                startSetupBtn.textContent = 'üöÄ Iniciar Configuraci√≥n';
            }
        });
        
        // Funciones de configuraci√≥n espec√≠ficas para ferreter√≠a
        async function createDatabaseStructure() {
            // Crear colecciones base con documentos iniciales
            await db.collection('system').doc('config').set({
                version: '1.0.0',
                setupDate: new Date().toISOString(),
                setupCompleted: true,
                businessType: 'ferreteria',
                firebaseConfig: defaultFirebaseConfig,
                features: ['offline', 'multi-local', 'stock-control', 'barcode', 'budgets', 'clients']
            });
        }
        
        async function createBusiness(data) {
            const businessRef = db.collection('businesses').doc();
            await businessRef.set({
                ...data,
                id: businessRef.id,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                firebaseProjectId: defaultFirebaseConfig.projectId,
                status: 'active'
            });
            return businessRef.id;
        }
        
        async function createLocal(data, businessId) {
            const localRef = db.collection('locals').doc();
            await localRef.set({
                ...data,
                id: localRef.id,
                businessId: businessId,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            });
            return localRef.id;
        }
        
        async function createFerreteriaUsers(adminEmail, localId) {
            try {
                // Usuario Administrador
                const adminCredential = await auth.createUserWithEmailAndPassword(adminEmail, 'Admin123!');
                
                const adminUserRef = db.collection('users').doc();
                await adminUserRef.set({
                    id: adminUserRef.id,
                    email: adminEmail,
                    name: 'Administrador Ferreter√≠a',
                    role: 'admin',
                    localId: localId,
                    permissions: ['all'],
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    createdBy: 'system',
                    uid: adminCredential.user.uid
                });
                
                // Usuario Cajero
                const cashierCredential = await auth.createUserWithEmailAndPassword('cajero@ferreteria.com', 'Cajero123!');
                
                const cashierUserRef = db.collection('users').doc();
                await cashierUserRef.set({
                    id: cashierUserRef.id,
                    email: 'cajero@ferreteria.com',
                    name: 'Cajero Principal',
                    role: 'cajero',
                    localId: localId,
                    permissions: ['sales', 'cashbox', 'read_products', 'clients'],
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    createdBy: 'system',
                    uid: cashierCredential.user.uid
                });
                
                // Usuario Vendedor
                const sellerCredential = await auth.createUserWithEmailAndPassword('vendedor@ferreteria.com', 'Vendedor123!');
                
                const sellerUserRef = db.collection('users').doc();
                await sellerUserRef.set({
                    id: sellerUserRef.id,
                    email: 'vendedor@ferreteria.com',
                    name: 'Vendedor / Asesor',
                    role: 'vendedor',
                    localId: localId,
                    permissions: ['sales', 'budgets', 'read_products', 'clients'],
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    createdBy: 'system',
                    uid: sellerCredential.user.uid
                });
                
                // Usuario Dep√≥sito
                const stockCredential = await auth.createUserWithEmailAndPassword('deposito@ferreteria.com', 'Deposito123!');
                
                const stockUserRef = db.collection('users').doc();
                await stockUserRef.set({
                    id: stockUserRef.id,
                    email: 'deposito@ferreteria.com',
                    name: 'Encargado de Dep√≥sito',
                    role: 'stock',
                    localId: localId,
                    permissions: ['products', 'stock', 'providers', 'read_sales'],
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    createdBy: 'system',
                    uid: stockCredential.user.uid
                });
                
            } catch (error) {
                // Si los usuarios ya existen, solo crear los documentos en Firestore
                if (error.code === 'auth/email-already-in-use') {
                    showStatus('Usuarios ya exist√≠an en Firebase Auth. Creando documentos en Firestore...', 'warning');
                    
                    // Crear documentos de usuario sin crear en Auth
                    const batch = db.batch();
                    
                    const adminUserRef = db.collection('users').doc();
                    batch.set(adminUserRef, {
                        id: adminUserRef.id,
                        email: adminEmail,
                        name: 'Administrador Ferreter√≠a',
                        role: 'admin',
                        localId: localId,
                        permissions: ['all'],
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        createdBy: 'system',
                        uid: 'existing-user-admin'
                    });
                    
                    const cashierUserRef = db.collection('users').doc();
                    batch.set(cashierUserRef, {
                        id: cashierUserRef.id,
                        email: 'cajero@ferreteria.com',
                        name: 'Cajero Principal',
                        role: 'cajero',
                        localId: localId,
                        permissions: ['sales', 'cashbox', 'read_products', 'clients'],
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        createdBy: 'system',
                        uid: 'existing-user-cashier'
                    });
                    
                    const sellerUserRef = db.collection('users').doc();
                    batch.set(sellerUserRef, {
                        id: sellerUserRef.id,
                        email: 'vendedor@ferreteria.com',
                        name: 'Vendedor / Asesor',
                        role: 'vendedor',
                        localId: localId,
                        permissions: ['sales', 'budgets', 'read_products', 'clients'],
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        createdBy: 'system',
                        uid: 'existing-user-seller'
                    });
                    
                    const stockUserRef = db.collection('users').doc();
                    batch.set(stockUserRef, {
                        id: stockUserRef.id,
                        email: 'deposito@ferreteria.com',
                        name: 'Encargado de Dep√≥sito',
                        role: 'stock',
                        localId: localId,
                        permissions: ['products', 'stock', 'providers', 'read_sales'],
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        createdBy: 'system',
                        uid: 'existing-user-stock'
                    });
                    
                    await batch.commit();
                    
                } else {
                    throw error;
                }
            }
        }
        
        async function createFerreteriaSuppliers(localId) {
            const suppliers = [
                {
                    name: 'ACINDAR S.A.',
                    code: 'ACI001',
                    category: 'materiales',
                    contact: 'Juan Rodr√≠guez',
                    phone: '+54 11 4321-0001',
                    email: 'ventas@acindar.com',
                    products: ['hierro', 'alambre', 'perfiles'],
                    paymentTerms: '30 d√≠as',
                    rating: 5
                },
                {
                    name: 'BOSCH Herramientas',
                    code: 'BOS001',
                    category: 'herramientas',
                    contact: 'Mar√≠a G√≥mez',
                    phone: '+54 11 4321-0002',
                    email: 'distribucion@bosch.com',
                    products: ['taladros', 'amoladoras', 'sierras'],
                    paymentTerms: 'Contado',
                    rating: 5
                },
                {
                    name: 'SIAM Electricidad',
                    code: 'SIA001',
                    category: 'electricidad',
                    contact: 'Carlos L√≥pez',
                    phone: '+54 11 4321-0003',
                    email: 'ventas@siamelectric.com',
                    products: ['cables', 'llaves', 'portal√°mparas'],
                    paymentTerms: '15 d√≠as',
                    rating: 4
                },
                {
                    name: 'FV Plomer√≠a',
                    code: 'FVP001',
                    category: 'plomeria',
                    contact: 'Fernando Vargas',
                    phone: '+54 11 4321-0004',
                    email: 'info@fvplomeria.com',
                    products: ['ca√±os', 'accesorios', 'grifer√≠a'],
                    paymentTerms: '7 d√≠as',
                    rating: 4
                },
                {
                    name: 'ALBA Pinturas',
                    code: 'ALB001',
                    category: 'pintura',
                    contact: 'Ana Mart√≠nez',
                    phone: '+54 11 4321-0005',
                    email: 'ventas@albapinturas.com',
                    products: ['pinturas', 'barnices', 'selladores'],
                    paymentTerms: '30 d√≠as',
                    rating: 4
                }
            ];
            
            const batch = db.batch();
            
            suppliers.forEach(supplier => {
                const supplierRef = db.collection('providers').doc();
                batch.set(supplierRef, {
                    ...supplier,
                    id: supplierRef.id,
                    localId: localId,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                });
            });
            
            await batch.commit();
            return suppliers.length;
        }
        
        async function createFerreteriaProducts(localId, categories, countPerCategory) {
            // Definir productos por categor√≠a
            const productsByCategory = {
                herramientas: [
                    { name: 'Martillo de Carpintero 500g', unit: 'unidad', cost: 1200, margin: 40 },
                    { name: 'Destornillador Phillips #2', unit: 'unidad', cost: 850, margin: 45 },
                    { name: 'Alicate Universal 8"', unit: 'unidad', cost: 1500, margin: 35 },
                    { name: 'Llave Francesa 10"', unit: 'unidad', cost: 2200, margin: 38 },
                    { name: 'Taladro Percutor 650W', unit: 'unidad', cost: 18500, margin: 30 },
                    { name: 'Amoladora Angular 4 1/2"', unit: 'unidad', cost: 12500, margin: 32 },
                    { name: 'Sierra Caladora 500W', unit: 'unidad', cost: 9800, margin: 35 },
                    { name: 'Juego de Llaves Allen', unit: 'juego', cost: 3200, margin: 40 },
                    { name: 'Nivel de Burbuja 60cm', unit: 'unidad', cost: 1800, margin: 42 },
                    { name: 'Cinta M√©trica 5m', unit: 'unidad', cost: 950, margin: 45 }
                ],
                materiales: [
                    { name: 'Cemento Loma Negra 50kg', unit: 'bolsa', cost: 2500, margin: 25 },
                    { name: 'Cal Hidratada 30kg', unit: 'bolsa', cost: 1800, margin: 28 },
                    { name: 'Arena M3', unit: 'm3', cost: 8500, margin: 30 },
                    { name: 'Piedra Partida M3', unit: 'm3', cost: 9500, margin: 30 },
                    { name: 'Hierro 8mm x 12m', unit: 'unidad', cost: 4500, margin: 35 },
                    { name: 'Hierro 10mm x 12m', unit: 'unidad', cost: 6500, margin: 35 },
                    { name: 'Alambre Recocido #18', unit: 'kg', cost: 1200, margin: 40 },
                    { name: 'Malla Sima 15x15', unit: 'm2', cost: 850, margin: 38 },
                    { name: 'Ladrillo Com√∫n x 1000', unit: 'millar', cost: 28000, margin: 20 },
                    { name: 'Bloque de Hormig√≥n 13x19x39', unit: 'unidad', cost: 320, margin: 35 }
                ],
                electricidad: [
                    { name: 'Cable bipolar 2x1.5mm', unit: 'rollo_100m', cost: 18500, margin: 30 },
                    { name: 'Cable unipolar 2.5mm', unit: 'rollo_100m', cost: 22500, margin: 30 },
                    { name: 'Llave T√©rmica 2x10A', unit: 'unidad', cost: 2800, margin: 40 },
                    { name: 'Toma Corriente 2P+T', unit: 'unidad', cost: 850, margin: 45 },
                    { name: 'Interruptor Simple', unit: 'unidad', cost: 650, margin: 48 },
                    { name: 'Portal√°mparas E27', unit: 'unidad', cost: 450, margin: 50 },
                    { name: 'Foco LED 9W E27', unit: 'unidad', cost: 1200, margin: 42 },
                    { name: 'Tubo LED 18W 60cm', unit: 'unidad', cost: 2800, margin: 40 },
                    { name: 'Caja Octogonal', unit: 'unidad', cost: 320, margin: 55 },
                    { name: 'Canaleta 20x10mm', unit: 'unidad_2m', cost: 950, margin: 45 }
                ],
                plomeria: [
                    { name: 'Ca√±o PVC 1/2" x 6m', unit: 'unidad', cost: 2800, margin: 35 },
                    { name: 'Ca√±o PVC 3/4" x 6m', unit: 'unidad', cost: 3800, margin: 35 },
                    { name: 'Codo PVC 90¬∞ 1/2"', unit: 'unidad', cost: 180, margin: 60 },
                    { name: 'Tee PVC 1/2"', unit: 'unidad', cost: 220, margin: 60 },
                    { name: 'Llave de Paso 1/2"', unit: 'unidad', cost: 2500, margin: 45 },
                    { name: 'Grifer√≠a Monocomando Cocina', unit: 'unidad', cost: 8500, margin: 40 },
                    { name: 'Grifer√≠a Lavatorio', unit: 'unidad', cost: 6500, margin: 42 },
                    { name: 'Sif√≥n Cromado 1 1/2"', unit: 'unidad', cost: 3200, margin: 45 },
                    { name: 'Junta de Goma 1/2"', unit: 'unidad', cost: 50, margin: 100 },
                    { name: 'Cinta de Tefl√≥n', unit: 'rollo', cost: 450, margin: 60 }
                ],
                pintura: [
                    { name: 'Pintura L√°tex Blanco 20L', unit: 'balde', cost: 28500, margin: 30 },
                    { name: 'Pintura Esmalte Sint√©tico 4L', unit: 'lata', cost: 12500, margin: 35 },
                    { name: 'Impermeabilizante Acr√≠lico 20L', unit: 'balde', cost: 32000, margin: 28 },
                    { name: 'Barniz Poliuret√°nico 4L', unit: 'lata', cost: 18500, margin: 32 },
                    { name: 'Rodillo de Pelo 9"', unit: 'unidad', cost: 1800, margin: 45 },
                    { name: 'Brocha 2"', unit: 'unidad', cost: 950, margin: 50 },
                    { name: 'Lija al Agua #180', unit: 'hoja', cost: 250, margin: 60 },
                    { name: 'Masilla Acr√≠lica 1kg', unit: 'pote', cost: 2800, margin: 40 },
                    { name: 'Cinta de Enmascarar 48mm', unit: 'rollo', cost: 850, margin: 55 },
                    { name: 'Papel Misionero 50m', unit: 'rollo', cost: 3200, margin: 45 }
                ],
                seguridad: [
                    { name: 'Candado de Seguridad 40mm', unit: 'unidad', cost: 3200, margin: 40 },
                    { name: 'Cerradura para Puerta', unit: 'unidad', cost: 8500, margin: 35 },
                    { name: 'Llave Tipo Yale', unit: 'unidad', cost: 450, margin: 80 },
                    { name: 'Bisagra 4" Acero', unit: 'par', cost: 1800, margin: 45 },
                    { name: 'Picaporte Exterior', unit: 'unidad', cost: 5500, margin: 38 },
                    { name: 'Cadena con Candado', unit: 'unidad', cost: 4200, margin: 42 },
                    { name: 'Mirilla Puerta', unit: 'unidad', cost: 2800, margin: 50 },
                    { name: 'Cilindro Europeo', unit: 'unidad', cost: 6500, margin: 40 },
                    { name: 'Pasador de Seguridad', unit: 'unidad', cost: 950, margin: 55 },
                    { name: 'Cerrojo Deslizante', unit: 'unidad', cost: 3800, margin: 45 }
                ],
                jardin: [
                    { name: 'Manguera 1/2" x 25m', unit: 'rollo', cost: 8500, margin: 35 },
                    { name: 'Regador Oscilante', unit: 'unidad', cost: 6500, margin: 40 },
                    { name: 'Pico para Manguera', unit: 'unidad', cost: 2800, margin: 45 },
                    { name: 'Corta C√©sped Manual', unit: 'unidad', cost: 12500, margin: 30 },
                    { name: 'Tijera de Podar', unit: 'unidad', cost: 4500, margin: 42 },
                    { name: 'Rastrillo 16 Dientes', unit: 'unidad', cost: 3800, margin: 45 },
                    { name: 'Pala Recta', unit: 'unidad', cost: 5500, margin: 40 },
                    { name: 'Carretilla 65L', unit: 'unidad', cost: 28500, margin: 25 },
                    { name: 'Guantes de Jardiner√≠a', unit: 'par', cost: 1800, margin: 50 },
                    { name: 'Tierra Abonada 20L', unit: 'bolsa', cost: 2200, margin: 45 }
                ],
                fijacion: [
                    { name: 'Tornillo Tirafondo 3x40', unit: 'caja_100', cost: 3200, margin: 45 },
                    { name: 'Tornillo Madera 3x40', unit: 'caja_100', cost: 2800, margin: 48 },
                    { name: 'Clavo 2" x 1kg', unit: 'kg', cost: 1800, margin: 50 },
                    { name: 'Tarugo Nylon 6x30', unit: 'caja_100', cost: 950, margin: 60 },
                    { name: 'Ancla Qu√≠mica M8', unit: 'caja_20', cost: 6500, margin: 40 },
                    { name: 'Taco Fischer S6', unit: 'caja_100', cost: 2200, margin: 55 },
                    { name: 'Grapas para Malla', unit: 'caja_1000', cost: 1800, margin: 60 },
                    { name: 'Alambre de Atar 1kg', unit: 'kg', cost: 2800, margin: 45 },
                    { name: 'Remache Pop 4mm', unit: 'caja_100', cost: 3200, margin: 50 },
                    { name: 'Pernos 10mm x 100mm', unit: 'caja_25', cost: 5500, margin: 42 }
                ]
            };
            
            // Crear categor√≠as en Firestore
            const categoryRefs = {};
            for (const categoryName of categories) {
                const categoryRef = db.collection('categories').doc();
                await categoryRef.set({
                    id: categoryRef.id,
                    name: categoryName.charAt(0).toUpperCase() + categoryName.slice(1),
                    localId: localId,
                    businessType: 'ferreteria',
                    isActive: true,
                    createdAt: new Date().toISOString()
                });
                categoryRefs[categoryName] = categoryRef.id;
            }
            
            // Crear productos
            let totalProducts = 0;
            for (const categoryName of categories) {
                const categoryProducts = productsByCategory[categoryName] || [];
                const productsToCreate = Math.min(countPerCategory, categoryProducts.length);
                
                for (let i = 0; i < productsToCreate; i++) {
                    const product = categoryProducts[i];
                    const productRef = db.collection('products').doc();
                    
                    const price = product.cost * (1 + product.margin / 100);
                    const barcode = `789${String(1000000 + totalProducts + 1).padStart(10, '0')}`;
                    
                    await productRef.set({
                        id: productRef.id,
                        code: `FER-${categoryName.substring(0, 3).toUpperCase()}-${String(totalProducts + 1).padStart(4, '0')}`,
                        barcode: barcode,
                        name: product.name,
                        description: `${product.name} - Ferreter√≠a`,
                        cost: product.cost,
                        margin: product.margin,
                        price: Math.round(price * 100) / 100,
                        stock: Math.floor(Math.random() * 50) + 10,
                        minStock: 5,
                        unit: product.unit,
                        categoryId: categoryRefs[categoryName],
                        categoryName: categoryName,
                        localId: localId,
                        isActive: true,
                        hasStockControl: true,
                        businessType: 'ferreteria',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    });
                    
                    totalProducts++;
                }
            }
            
            return totalProducts;
        }
        
        async function setupFerreteriaSystem(localId, businessData) {
            // Configuraci√≥n del sistema para ferreter√≠a
            const settingsRef = db.collection('settings').doc('system');
            await settingsRef.set({
                localId: localId,
                currency: 'ARS',
                currencySymbol: '$',
                decimalPlaces: 2,
                taxRate: 21,
                lowStockThreshold: 5,
                offlineMode: true,
                printTickets: true,
                printBusinessName: businessData.name,
                printAddress: businessData.address,
                printPhone: businessData.phone,
                printCUIT: businessData.cuit || '',
                businessType: 'ferreteria',
                updatedAt: new Date().toISOString()
            });
            
            // Permisos espec√≠ficos para ferreter√≠a
            const permissionsRef = db.collection('settings').doc('permissions');
            await permissionsRef.set({
                localId: localId,
                roles: {
                    admin: ['all'],
                    cajero: ['sales', 'cashbox', 'read_products', 'clients', 'returns'],
                    vendedor: ['sales', 'budgets', 'read_products', 'clients', 'read_prices'],
                    stock: ['products', 'stock', 'providers', 'read_sales', 'inventory']
                },
                businessType: 'ferreteria',
                updatedAt: new Date().toISOString()
            });
            
            // Configuraci√≥n de precios
            const pricingRef = db.collection('settings').doc('pricing');
            await pricingRef.set({
                localId: localId,
                defaultMargin: 40,
                minMargin: 20,
                maxDiscount: 15,
                roundPrices: true,
                priceMultiple: 10,
                businessType: 'ferreteria',
                updatedAt: new Date().toISOString()
            });
        }
        
        function validateRequiredFields() {
            const requiredFields = [
                'business-name',
                'business-address',
                'local-name',
                'local-code'
            ];
            
            let isValid = true;
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.style.borderColor = '#dc2626';
                    isValid = false;
                } else {
                    field.style.borderColor = '';
                }
            });
            
            if (!isValid) {
                showError('Completa todos los campos requeridos (*)');
            }
            
            return isValid;
        }
        
        function updateProgress(message, percentage) {
            currentOperation.textContent = message;
            progressFill.style.width = `${percentage}%`;
            
            // Mostrar mensaje de progreso
            const progressMsg = document.createElement('div');
            progressMsg.className = 'status-info';
            progressMsg.textContent = `‚úì ${message}`;
            statusMessages.appendChild(progressMsg);
            
            // Scroll al final
            statusMessages.scrollTop = statusMessages.scrollHeight;
        }
        
        function showStatus(message, type = 'info') {
            const statusMsg = document.createElement('div');
            statusMsg.className = `status-${type}`;
            statusMsg.textContent = message;
            statusMessages.appendChild(statusMsg);
            
            // Scroll al final
            statusMessages.scrollTop = statusMessages.scrollHeight;
            
            // Auto-remover despu√©s de 10 segundos
            setTimeout(() => {
                if (statusMsg.parentNode) {
                    statusMsg.remove();
                }
            }, 10000);
        }
        
        function showError(message) {
            showStatus(message, 'error');
        }
        
        // Inicializar bot√≥n
        startSetupBtn.disabled = true;
        
        // Probar conexi√≥n autom√°ticamente despu√©s de 1 segundo
        setTimeout(() => {
            testConnectionBtn.click();
        }, 1000);
    </script>
</body>
</html>
